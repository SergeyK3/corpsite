# ADR-003: HTTP Error Semantics for Task Workflow

**Статус:** Accepted  
**Дата:** 2026-01-09  
**Контекст системы:** Corpsite API (Tasks / Workflow / RBAC)

---

## Контекст

В системе Corpsite реализован API управления задачами с:

- ролевой моделью доступа (initiator / executor / supervisor / deputy),
- пошаговым workflow (IN_PROGRESS → WAITING_REPORT → WAITING_APPROVAL → DONE),
- использованием API как backend-контракта для:
  - Web UI (личные кабинеты),
  - Telegram-бота,
  - автотестов.

Требовалось определить **строгую, предсказуемую и расширяемую семантику HTTP-ошибок**, исключающую:
- утечки информации,
- неоднозначные реакции клиента,
- зависимость от текстов сообщений.

---

## Принятое решение

### 1. Семантика HTTP-кодов

Используется строгое разделение ответственности HTTP-кодов:

| HTTP | Назначение |
|----|----|
| **401 Unauthorized** | Отсутствует или некорректна аутентификация |
| **404 Not Found** | Объект не существует **или скрыт от пользователя** |
| **403 Forbidden** | Объект виден, но действие **запрещено по ACL / ролям** |
| **409 Conflict** | Объект виден, действие разрешено, но **нарушена бизнес-последовательность** |
| **422 Unprocessable Entity** | Ошибка входных данных |

---

### 2. Принцип сокрытия объектов

Если пользователь **не имеет права видеть задачу**, API всегда возвращает:

